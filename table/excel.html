<html>
<head>
	<title>Excel</title>
</head>
<body>
	<input onclick="createTable()" type=button value="CreateTable" />
    <input onclick="addRow()" type=button value="Row++" />
    <input onclick="addColumn()" type=button value="Column++" />
	<script type="text/javascript">
		document.getElementsByTagName('body')[0].addEventListener('click', oneClick,true);
		function createTable(){
			var body = document.getElementsByTagName('body')[0];
			var table = document.createElement('table');
			table.id = 'table';
			body.appendChild(table);
		}
		function addRow(){
			var table = document.getElementById('table');
			var rowThere = document.getElementById('row');
			var row = document.createElement('tr');
			var input;
			row.id = 'row';
			if(!rowThere){
				table.appendChild(row);
			}else{
				var elements = rowThere.getElementsByTagName('*');
				for(var i = 0; i < elements.length/2; i++){
					var td = document.createElement('td');
					input = document.createElement('input');
					input.id = 'column';
					input.readOnly = 1;
					input.ondblclick = doubleClick;
					td.appendChild(input);
					row.appendChild(td);
				}
				table.appendChild(row);
			}
		}
		function addColumn(){
			var tr = document.getElementsByTagName('tr');
			var td;
			var input;
			for(var i = 0; i < tr.length; i++){
				td = document.createElement('td');
				input = document.createElement('input');
				input.id = 'column';
				input.readOnly = 1;
				input.ondblclick=doubleClick;
				td.appendChild(input)
				tr[i].appendChild(td);
			}
		}
		function doubleClick(){
			this.style.cursor = 'none';
			this.style.padding = 4;
			this.readOnly = 0;
			}
		function oneClick(){
			var input = document.getElementsByTagName('input');
			for(var i = 0;i <document.getElementsByTagName('input').length; i++){
				input[i].style.cursor = 'default';
				input[i].style.padding = 1;
				input[i].readOnly = 1; 
			} 
		}
	</script>
</body>
</html>